# Fargate Smishing Analysis Bot

ì„œë²„ë¦¬ìŠ¤(AWS Fargate Spot) í™˜ê²½ì—ì„œ ë™ì‘í•˜ëŠ” ìŠ¤ë¯¸ì‹± ì‚¬ì´íŠ¸ ë¶„ì„ ë´‡ì…ë‹ˆë‹¤.
Playwrightì™€ Stealth í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ íƒì§€ë¥¼ ìš°íšŒí•˜ë©°, ëŒ€ìƒ ì‚¬ì´íŠ¸ì˜ ìŠ¤í¬ë¦°ìƒ·, ì†ŒìŠ¤ ì½”ë“œ, ë„¤íŠ¸ì›Œí¬ íŒ¨í‚·(HAR), ì¿ í‚¤/ìŠ¤í† ë¦¬ì§€ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ì—¬ S3ì— ì €ì¥í•©ë‹ˆë‹¤.

## ğŸ— ì•„í‚¤í…ì²˜ (Architecture)

**í•µì‹¬ íŠ¹ì§•:**
*   **100% Serverless**: ê´€ë¦¬í•  EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.
*   **One-off Execution**: í•­ìƒ ì‹¤í–‰ë˜ì§€ ì•Šê³ , `make run` ëª…ë ¹ì„ ë‚´ë¦´ ë•Œë§Œ Fargate Taskê°€ ìƒì„±ë˜ì–´ ì‹¤í–‰ë˜ê³  ì¢…ë£Œë©ë‹ˆë‹¤. (ë¹„ìš© ì ˆê°)
*   **Spot Instances**: Fargate Spotì„ 100% ì‚¬ìš©í•˜ì—¬ ë¹„ìš©ì„ ìµœì†Œí™”í–ˆìŠµë‹ˆë‹¤.
*   **Circuit Breaker**: ë°°í¬ ì‹¤íŒ¨ ì‹œ ìë™ìœ¼ë¡œ ë¡¤ë°±ë˜ì–´ ë¬´í•œ ì¬ì‹œë„ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.

**êµ¬ì„± ìš”ì†Œ:**
*   **AWS ECS**: Fargate Cluster (Clusterë§Œ ì¡´ì¬, Service ì—†ìŒ)
*   **AWS ECR**: Docker ì´ë¯¸ì§€ ì €ì¥ì†Œ (`smishing-bot`)
*   **AWS S3**: ë¶„ì„ ê²°ê³¼ ì €ì¥ì†Œ (`smishing-analysis-results-...`)
*   **AWS CloudWatch**: ë¶„ì„ ë¡œê·¸ ì €ì¥ì†Œ (`/ecs/smishing-analysis`)

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡° (Structure)

```text
.
â”œâ”€â”€ app/                  # ì• í”Œë¦¬ì¼€ì´ì…˜ ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ Dockerfile        # ë¶„ì„ìš© ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì •ì˜
â”‚   â”œâ”€â”€ index.js          # Playwright ë¶„ì„ ë¡œì§ (Stealth ì ìš©)
â”‚   â””â”€â”€ package.json      # Node.js ì˜ì¡´ì„±
â”œâ”€â”€ scripts/              # ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ëª¨ìŒ
â”‚   â”œâ”€â”€ push.sh           # Docker ë¹Œë“œ ë° ECR ì—…ë¡œë“œ
â”‚   â”œâ”€â”€ run_task.sh       # Fargate Task ë‹¨ì¼ ì‹¤í–‰
â”‚   â”œâ”€â”€ run_with_retry.sh # ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ì‹¤í–‰ (ìµœëŒ€ 3íšŒ)
â”‚   â”œâ”€â”€ check_status.sh   # ì‹¤í–‰ ì¤‘ì¸ íƒœìŠ¤í¬ ìƒíƒœ í™•ì¸
â”‚   â””â”€â”€ ls_results.sh     # S3 ê²°ê³¼ íŒŒì¼ í™•ì¸
â”œâ”€â”€ main.tf               # Terraform ì¸í”„ë¼ ì •ì˜
â”œâ”€â”€ Makefile              # ëª…ë ¹ì–´ ë‹¨ì¶•í‚¤ (ì—”íŠ¸ë¦¬í¬ì¸íŠ¸)
â””â”€â”€ terraform.tfvars      # (Git ì œì™¸ë¨) VPC, Subnet ë“± ë¯¼ê° ì„¤ì •
```

## ğŸš€ ì‹œì‘í•˜ê¸° (Getting Started)

### ì‚¬ì „ ìš”êµ¬ ì‚¬í•­ (Prerequisites)
*   AWS CLI (í”„ë¡œí•„ ì„¤ì • í•„ìš”: `Admin@aground5`)
*   Terraform
*   Docker Desktop
*   `make` (macOS/Linux ê¸°ë³¸ í¬í•¨)

### 1ï¸âƒ£ ì¸í”„ë¼ ë°°í¬ (Infrastructure)
AWS ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
```bash
make setup  # terraform init
make deploy # terraform apply
```

### 2ï¸âƒ£ ì´ë¯¸ì§€ ë¹Œë“œ ë° ì—…ë¡œë“œ (Build & Push)
ë¡œì»¬ì—ì„œ Docker ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  ECRë¡œ ì—…ë¡œë“œí•©ë‹ˆë‹¤.
ìë™ìœ¼ë¡œ `linux/amd64` ì•„í‚¤í…ì²˜ë¡œ ë¹Œë“œë˜ë©°, Fargate í˜¸í™˜ì„± ë¬¸ì œê°€ í•´ê²°ëœ ë²„ì „ì…ë‹ˆë‹¤.
```bash
make build
```

### 3ï¸âƒ£ ë¶„ì„ ì‹¤í–‰ (Run Analysis)
íŠ¹ì • URLì„ ëŒ€ìƒìœ¼ë¡œ ë¶„ì„ì„ ì‹œì‘í•©ë‹ˆë‹¤.

**ë‹¨ì¼ ì‹¤í–‰ (í•œ ë²ˆë§Œ ì‹œë„):**
```bash
make run url=http://example.com
```

**ì¬ì‹œë„ ì‹¤í–‰ (ì‹¤íŒ¨ ì‹œ ìµœëŒ€ 3íšŒ ìë™ ì¬ì‹œë„):** - **ê¶Œì¥**
```bash
make retry url=http://example.com
```

### 4ï¸âƒ£ ìƒíƒœ ë° ê²°ê³¼ í™•ì¸ (Monitor & Verify)

**ì‹¤í–‰ ìƒíƒœ í™•ì¸:**
í˜„ì¬ ì‹¤í–‰ ì¤‘ì´ê±°ë‚˜ ìµœê·¼ ì¢…ë£Œëœ íƒœìŠ¤í¬ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
```bash
make status
```

**ê²°ê³¼ í™•ì¸ (S3):**
ë¶„ì„ì´ ì™„ë£Œë˜ë©´ ê²°ê³¼ íŒŒì¼ ëª©ë¡ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
```bash
make results
```
*   `screenshot.png`: ì ‘ì† í™”ë©´ ìŠ¤í¬ë¦°ìƒ·
*   `report.json`: ë¦¬ë””ë ‰ì…˜, ì¿ í‚¤, ì…ë ¥ í•„ë“œ ë“± ë¶„ì„ ë¦¬í¬íŠ¸
*   `network.har`: ì „ì²´ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ë¡œê·¸
*   `source.html`: í˜ì´ì§€ ì›ë³¸ ì†ŒìŠ¤

### 5ï¸âƒ£ ë¦¬ì†ŒìŠ¤ ì •ë¦¬ (Cleanup)
ëª¨ë“  AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤. (S3 ë²„í‚· ë‚´ìš©ë¬¼ê³¼ ECR ì´ë¯¸ì§€ë„ ê°•ì œë¡œ ì‚­ì œë©ë‹ˆë‹¤)
```bash
make destroy
```

## ğŸ›  ë¬¸ì œ í•´ê²° (Troubleshooting)

**Q: `make status` í•´ë„ ì•„ë¬´ê²ƒë„ ì•ˆ ë‚˜ì™€ìš”.**
*   `make run` ì§í›„ì—ëŠ” `PROVISIONING` -> `PENDING` ìƒíƒœë¼ ëœ¨ëŠ” ë° 10~20ì´ˆ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
*   íƒœìŠ¤í¬ê°€ ì´ë¯¸ ì„±ê³µì ìœ¼ë¡œ ì¢…ë£Œë˜ì—ˆìœ¼ë©´ ëª©ë¡ì—ì„œ ì‚¬ë¼ì¡Œì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. `make results`ë¡œ í™•ì¸í•´ ë³´ì„¸ìš”.

**Q: `image Manifest does not contain descriptor matching platform` ì—ëŸ¬ê°€ ë– ìš”.**
*   ì´ì „ ë²„ì „ì˜ ì´ë¯¸ì§€ê°€ ë‚¨ì•„ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. `make build`ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ì„œ ì•„í‚¤í…ì²˜ê°€ ìˆ˜ì •ëœ(`--platform linux/amd64 --provenance=false`) ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.

**Q: ë¡œê·¸ëŠ” ì–´ë””ì„œ ë³´ë‚˜ìš”?**
*   AWS CloudWatch Console -> Log groups -> `/ecs/smishing-analysis`ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.
